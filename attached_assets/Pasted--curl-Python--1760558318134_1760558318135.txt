æˆ‘ä»¬å°†åˆ†ä¸¤æ­¥èµ°ï¼š
ç¬¬ä¸€æ­¥ï¼šå¿«é€ŸéªŒè¯ (ç”¨curlå‘½ä»¤) - è¿™æ˜¯æœ€å¿«ã€æœ€ç›´æ¥çš„æ–¹æ³•ï¼Œç”¨æ¥ç¡®è®¤æ‚¨çš„å¯†é’¥æ˜¯æœ‰æ•ˆçš„ã€‚
ç¬¬äºŒæ­¥ï¼šç¼–å†™Pythonä»£ç  - å°†è¿™ä¸ªåŠŸèƒ½é›†æˆåˆ°æ‚¨çš„ç½‘ç«™ä¸­ã€‚
ç¬¬ä¸€æ­¥ï¼šå¿«é€ŸéªŒè¯æ‚¨çš„APIå¯†é’¥
æˆ‘ä»¬å°†ä½¿ç”¨æ‚¨æœåŠ¡å•†æä¾›çš„curlå‘½ä»¤ï¼Œåœ¨Replitçš„ç»ˆç«¯(Shell)é‡Œç›´æ¥æµ‹è¯•â€œæ–‡ç”Ÿå›¾â€åŠŸèƒ½ã€‚
æ‰“å¼€Replitçš„Shellï¼š
åœ¨æ‚¨çš„Replité¡¹ç›®ç•Œé¢çš„å³ä¾§ï¼Œé€šå¸¸ä¼šæœ‰ä¸€ä¸ªæ˜¾ç¤ºä»£ç è¾“å‡ºçš„çª—å£ã€‚åœ¨è¿™ä¸ªçª—å£çš„é¡¶éƒ¨ï¼Œæ‰¾åˆ°å¹¶ç‚¹å‡» Shell æ ‡ç­¾é¡µã€‚
æ‚¨ä¼šçœ‹åˆ°ä¸€ä¸ªé»‘è‰²çš„å‘½ä»¤è¡Œçª—å£ï¼Œå¯ä»¥åœ¨é‡Œé¢è¾“å…¥å‘½ä»¤ã€‚
å‡†å¤‡æ‚¨çš„curlå‘½ä»¤ï¼š
è¯·å®Œæ•´å¤åˆ¶ä¸‹é¢è¿™ä¸ªä»£ç å—ã€‚æˆ‘å·²ç»å°†ç¤ºä¾‹ä¸­çš„å¯†é’¥æ›¿æ¢æˆäº†æ‚¨æä¾›çš„å¯†é’¥ sk-4i7...ã€‚
code
Bash
curl --location 'https://ai.juguang.chat/v1beta/models/gemini-2.5-flash-image-preview:generateContent' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer sk-4i7CZVlFeglKEDfSwPU0qie0ZgDYIlnsp0rBgdINm6foubVs' \
--data '{
      "contents": [{
        "parts": [{
          "text": "ç”Ÿæˆä¸€å¼ éå¸¸å¯çˆ±çš„ç™½è‰²å°çŒ«çš„ç‰¹å†™ç…§ç‰‡ï¼Œçœ¼ç›æ˜¯è“è‰²çš„ï¼ŒèƒŒæ™¯æ˜¯æ¨¡ç³Šçš„èŠ±å›­"
        }]
      }]
    }'
æ‰§è¡Œå‘½ä»¤ï¼š
å°†ä¸Šé¢æ•´æ®µå‘½ä»¤ç²˜è´´åˆ°æ‚¨æ‰“å¼€çš„Shellçª—å£ä¸­ã€‚
æŒ‰ä¸‹ Enter é”®ã€‚
æ£€æŸ¥ç»“æœï¼š
å¦‚æœæˆåŠŸï¼šæ‚¨åº”è¯¥ä¼šçœ‹åˆ°Shellçª—å£ä¸­è¿”å›äº†ä¸€å¤§ä¸²ä»¥ {"candidates": ...} å¼€å¤´çš„æ–‡æœ¬ï¼ˆJSONæ ¼å¼ï¼‰ã€‚åœ¨è¿™æ®µæ–‡æœ¬é‡Œï¼Œæ‚¨ä¼šæ‰¾åˆ°ä¸€ä¸ªå¾ˆé•¿çš„ã€ç”±éšæœºå­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œè¿™å°±æ˜¯å›¾ç‰‡çš„base64ç¼–ç ã€‚çœ‹åˆ°è¿™ä¸ªï¼Œå°±ä»£è¡¨æ‚¨çš„APIå¯†é’¥æ˜¯æœ‰æ•ˆçš„ï¼
å¦‚æœå¤±è´¥ï¼šå¦‚æœæ‚¨çœ‹åˆ°ä»»ä½•åŒ…å« errorã€invalid api key æˆ– authentication error å­—æ ·çš„è¿”å›ä¿¡æ¯ï¼Œè¯·ä»”ç»†æ£€æŸ¥æ‚¨å¤åˆ¶çš„curlå‘½ä»¤ä¸­çš„å¯†é’¥æ˜¯å¦ä¸æ‚¨è´­ä¹°çš„å®Œå…¨ä¸€è‡´ï¼Œç¡®ä¿æ²¡æœ‰å¤šä½™çš„ç©ºæ ¼æˆ–å­—ç¬¦ã€‚
ç¬¬äºŒæ­¥ï¼šåœ¨æ‚¨çš„ç½‘ç«™ä¸­ç”¨Pythonä»£ç è°ƒç”¨API
æµ‹è¯•æˆåŠŸåï¼Œæˆ‘ä»¬ç°åœ¨æŠŠå®ƒå†™æˆPythonä»£ç ï¼Œè¿™æ ·æ‚¨çš„ç½‘ç«™å°±èƒ½çœŸæ­£åœ°ä½¿ç”¨å®ƒäº†ã€‚
åˆ›å»ºæˆ–æ‰“å¼€ä¸€ä¸ªPythonæ–‡ä»¶ï¼š
åœ¨æ‚¨Replité¡¹ç›®ç•Œé¢çš„å·¦ä¾§æ–‡ä»¶åˆ—è¡¨ä¸­ï¼Œæ‰¾åˆ°æ‚¨ç½‘ç«™çš„åç«¯é€»è¾‘æ–‡ä»¶ï¼ˆä¾‹å¦‚ main.py æˆ– app.pyï¼‰ã€‚
æˆ–è€…ï¼Œæ‚¨å¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ api_call_test.py æ¥å•ç‹¬æµ‹è¯•ã€‚
ç¼–å†™Pythonä»£ç ï¼š
è¯·å®Œæ•´å¤åˆ¶ä¸‹é¢çš„Pythonä»£ç ï¼Œå¹¶ç²˜è´´åˆ°æ‚¨çš„æ–‡ä»¶ä¸­ã€‚
æˆ‘å·²ç»å°†æ‚¨çš„å¯†é’¥å¡«å…¥äº†ä»£ç ä¸­ã€‚
code
Python
import requests
import json
import os
import base64 # å¯¼å…¥è¿™ä¸ªåº“ç”¨æ¥è§£ç å›¾ç‰‡

# --- 1. é…ç½®æ‚¨çš„å¯†é’¥å’ŒAPIåœ°å€ ---
# ã€æœ€ä½³å®è·µã€‘å¼ºçƒˆå»ºè®®æ‚¨å°†å¯†é’¥ä¿å­˜åœ¨Replitçš„Secretsä¸­ï¼Œè€Œä¸æ˜¯ç›´æ¥å†™åœ¨ä»£ç é‡Œã€‚
# æˆ‘ä»¬å…ˆç›´æ¥å†™åœ¨è¿™é‡Œè¿›è¡Œæµ‹è¯•ã€‚
API_KEY = "sk-4i7CZVlFeglKEDfSwPU0qie0ZgDYIlnsp0rBgdINm6foubVs"
IMAGE_API_URL = "https://ai.juguang.chat/v1beta/models/gemini-2.5-flash-image-preview:generateContent"

def generate_image(prompt_text):
    """
    ä½¿ç”¨èšå…‰Chatçš„ä¸­è½¬APIæ¥ç”Ÿæˆå›¾ç‰‡ã€‚
    :param prompt_text: å›¾ç‰‡çš„æ–‡å­—æè¿°ã€‚
    :return: æˆåŠŸæ—¶è¿”å›ä¿å­˜çš„å›¾ç‰‡æ–‡ä»¶åï¼Œå¤±è´¥æ—¶è¿”å›Noneã€‚
    """
    print(f"æ­£åœ¨æ ¹æ®æè¿°ç”Ÿæˆå›¾ç‰‡: '{prompt_text}'")
    
    # --- 2. å‡†å¤‡è¯·æ±‚å¤´å’Œæ•°æ® ---
    headers = {
        'Content-Type': 'application/json',
        'Authorization': f'Bearer {API_KEY}'
    }
    
    payload = json.dumps({
      "contents": [{
        "parts": [{
          "text": prompt_text
        }]
      }]
    })

    # --- 3. å‘é€è¯·æ±‚ ---
    try:
        response = requests.post(IMAGE_API_URL, headers=headers, data=payload)
        # æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ (çŠ¶æ€ç  200)
        response.raise_for_status() 
        
        # --- 4. è§£æè¿”å›ç»“æœå¹¶ä¿å­˜å›¾ç‰‡ ---
        result = response.json()
        
        # ä»è¿”å›çš„JSONä¸­æå–å›¾ç‰‡çš„base64ç¼–ç æ•°æ®
        # æ³¨æ„ï¼šè·¯å¾„å¯èƒ½å› APIè¿”å›æ ¼å¼å˜åŒ–è€Œå˜åŒ–ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
        image_base64_data = result['candidates'][0]['content']['parts'][0]['inlineData']['data']
        
        # è§£ç base64æ•°æ®å¹¶ä¿å­˜ä¸ºå›¾ç‰‡æ–‡ä»¶
        image_data = base64.b64decode(image_base64_data)
        
        output_filename = "generated_image.png"
        with open(output_filename, "wb") as f:
            f.write(image_data)
        
        print(f"å›¾ç‰‡ç”ŸæˆæˆåŠŸï¼å·²ä¿å­˜ä¸º: {output_filename}")
        return output_filename

    except requests.exceptions.RequestException as e:
        print(f"APIè¯·æ±‚å¤±è´¥: {e}")
        print("æœåŠ¡å™¨è¿”å›å†…å®¹:", response.text if 'response' in locals() else "æ— è¿”å›")
        return None
    except (KeyError, IndexError) as e:
        print(f"è§£æè¿”å›çš„JSONæ•°æ®å¤±è´¥: {e}")
        print("æ”¶åˆ°çš„åŸå§‹æ•°æ®:", response.text)
        return None

# --- è¿™æ˜¯ä¸€ä¸ªç›´æ¥è¿è¡Œæœ¬æ–‡ä»¶çš„æµ‹è¯•ç¤ºä¾‹ ---
if __name__ == '__main__':
    # æ‚¨å¯ä»¥åœ¨è¿™é‡Œä¿®æ”¹ä¸ºæ‚¨æƒ³ç”Ÿæˆçš„ä»»ä½•ç”»é¢
    prompt = "ä¸€ä¸ªå®‡èˆªå‘˜ï¼Œéª‘ç€ä¸€åŒ¹å‘å…‰çš„æœºæ¢°é©¬ï¼Œé©°éª‹åœ¨å½©è™¹è‰²çš„æ˜Ÿäº‘ä¹‹ä¸Šï¼Œæ•°å­—è‰ºæœ¯é£æ ¼"
    generate_image(prompt)
è¿è¡ŒPythonä»£ç ï¼š
å›åˆ°æ‚¨Replitçš„ Shell æ ‡ç­¾é¡µã€‚
è¾“å…¥å‘½ä»¤ python api_call_test.py (è¯·ç¡®ä¿æ–‡ä»¶åä¸æ‚¨åˆ›å»ºçš„ä¸€è‡´)ã€‚
æŒ‰ä¸‹ Enter é”®ã€‚
æ£€æŸ¥ç»“æœï¼š
æ‚¨åº”è¯¥ä¼šåœ¨Shellä¸­çœ‹åˆ° â€œå›¾ç‰‡ç”ŸæˆæˆåŠŸï¼...â€ çš„æç¤ºã€‚
åŒæ—¶ï¼Œåœ¨æ‚¨Replité¡¹ç›®å·¦ä¾§çš„æ–‡ä»¶åˆ—è¡¨ä¸­ï¼Œåº”è¯¥ä¼šå‡ºç°ä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œåä¸º generated_image.pngã€‚æ‚¨å¯ä»¥ç‚¹å‡»å®ƒæ¥æŸ¥çœ‹AIç”Ÿæˆçš„å›¾ç‰‡ã€‚
æœ€åä¸€æ­¥ï¼šé›†æˆåˆ°æ‚¨çš„ç½‘ç«™å¹¶ä½¿ç”¨Secretsï¼ˆå®‰å…¨å®è·µï¼‰
æµ‹è¯•æˆåŠŸåï¼Œæ‚¨éœ€è¦ï¼š
å°†å¯†é’¥å­˜å…¥Secretsï¼š
åœ¨Replitå·¦ä¾§å·¥å…·æ ï¼Œç‚¹å‡»é”å½¢å›¾æ ‡ ğŸ”’ (Secrets)ã€‚
åˆ›å»ºä¸€ä¸ªæ–°çš„Secretï¼š
Key: JUGUANG_API_KEY
Value: sk-4i7CZVlFeglKEDfSwPU0qie0ZgDYIlnsp0rBgdINm6foubVs
ä¿®æ”¹ä»£ç ä»¥ä½¿ç”¨Secretsï¼š
å°†ä»£ç ä¸­çš„ API_KEY = "sk-..." è¿™ä¸€è¡Œï¼Œä¿®æ”¹ä¸ºï¼š
API_KEY = os.environ.get("JUGUANG_API_KEY")
é›†æˆå‡½æ•°ï¼š
å°† generate_image(prompt_text) è¿™ä¸ªå‡½æ•°ï¼Œé›†æˆåˆ°æ‚¨ç½‘ç«™çš„åç«¯é€»è¾‘ä¸­ã€‚ä¾‹å¦‚ï¼Œå½“ç”¨æˆ·åœ¨å‰ç«¯ç‚¹å‡»â€œç”Ÿæˆâ€æŒ‰é’®æ—¶ï¼Œæ‚¨çš„åç«¯å°±è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚